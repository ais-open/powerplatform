# GitHub Copilot Instructions for Power Platform Repository

This file provides context and instructions for GitHub Copilot to better assist with development in this Power Platform repository.

## Repository Structure

This repository contains:
- **PCF Controls**: TypeScript/React-based Power Component Framework controls
- **Plugins**: C# Dataverse plugins for Power Platform
- **Solutions**: Power Platform solution files

## Development Context

### PCF Controls
- Built with TypeScript and React
- Use PowerApps Component Framework (PCF) APIs
- Follow Microsoft Power Apps coding standards
- Use ESLint for code quality
- Target ES2020+ JavaScript features

### Key Libraries and Frameworks
- React 18+ for UI components
- Fluent UI React for Microsoft design system
- TypeScript for type safety
- ESLint with Microsoft Power Apps plugin
- Power Apps Component Framework types

### Coding Patterns

#### PCF Control Structure
```typescript
import { IInputs, IOutputs } from "./generated/ManifestTypes";

export class YourControl implements ComponentFramework.StandardControl<IInputs, IOutputs> {
    // Component implementation
}
```

#### Common Power Platform Patterns
- Use `context.webAPI` for Dataverse operations
- Implement `updateView()` for property changes
- Use `notifyOutputChanged()` to update bound properties
- Handle `context.mode.isControlDisabled` for read-only states

### Plugin Development
- C# .NET Framework 4.6.2+
- Use Microsoft.CrmSdk.CoreAssemblies
- Follow early-bound entity patterns
- Implement proper error handling and logging

### File Naming Conventions
- PCF Controls: PascalCase for TypeScript files
- Plugins: PascalCase for C# files
- Configuration: lowercase with hyphens (kebab-case)

### Testing Patterns
- Use PCF test harness for component testing
- Mock ComponentFramework interfaces
- Test both online and offline scenarios

## Copilot Usage Guidelines

### Effective Prompts
- Specify "PCF control" or "Power Platform plugin" context
- Mention target Power Platform version if relevant
- Include specific ComponentFramework API requirements
- Reference existing patterns in the codebase

### Code Generation
- Always include proper TypeScript typing
- Follow existing ESLint configuration
- Use established error handling patterns
- Include necessary imports for Power Platform APIs

### Common Tasks
1. Creating new PCF controls
2. Adding properties to existing controls  
3. Implementing Dataverse API calls
4. Creating plugin step registrations
5. Writing unit tests for components

## Architecture Notes

### PCF Controls Architecture
- Separation of concerns: UI components, business logic, data access
- React functional components with hooks
- TypeScript interfaces for strong typing
- Fluent UI components for consistent styling

### Plugin Architecture  
- Early-bound entities for type safety
- Shared utility classes in Common folder
- Proper exception handling and logging
- Async operations where appropriate

### Solution Structure
- Managed solutions for distribution
- Unmanaged solutions for development
- Proper dependency management between components

## Best Practices

1. **Type Safety**: Always use TypeScript interfaces and types
2. **Error Handling**: Implement comprehensive error handling
3. **Performance**: Consider lazy loading and efficient rendering
4. **Accessibility**: Follow WCAG guidelines for UI components
5. **Localization**: Support multiple languages where applicable
6. **Testing**: Write unit tests for business logic
7. **Documentation**: Include JSDoc comments for public APIs

## Power Platform Specific Considerations

- Handle both Model-driven and Canvas app contexts
- Support both online and offline scenarios  
- Consider mobile form factors
- Implement proper security practices
- Follow Power Platform ALM best practices
- Use solution-aware components where possible

This context should help GitHub Copilot provide more accurate and relevant suggestions for Power Platform development in this repository.